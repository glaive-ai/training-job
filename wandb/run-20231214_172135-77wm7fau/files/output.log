
  0%|                                                                                                                                                                  | 0/3 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Traceback (most recent call last):
  File "/home/ubuntu/training-container/train.py", line 216, in train
    trainer.train()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1555, in train
    return inner_training_loop(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1910, in _inner_training_loop
    self.optimizer.step()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/accelerate/optimizer.py", line 142, in step
    self.optimizer.step(closure)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/optimizer.py", line 280, in wrapper
    out = func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/optimizer.py", line 33, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/adamw.py", line 171, in step
    adamw(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/adamw.py", line 321, in adamw
    func(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/adamw.py", line 389, in _single_tensor_adamw
    exp_avg.mul_(beta1).add_(grad, alpha=1 - beta1)
RuntimeError: The size of tensor a (32768512) must match the size of tensor b (262148096) at non-singleton dimension 0
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/ubuntu/training-container/train.py", line 228, in <module>
    train()
  File "/home/ubuntu/training-container/train.py", line 223, in train
    callback_completion(data_args.callback_url,None,True,str(e))
  File "/home/ubuntu/training-container/train.py", line 46, in callback_completion
    response = requests.post(callback_url, json=payload)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/sessions.py", line 575, in request
    prep = self.prepare_request(req)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/sessions.py", line 486, in prepare_request
    p.prepare(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/models.py", line 368, in prepare
    self.prepare_url(url, params)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/models.py", line 439, in prepare_url
    raise MissingSchema(
requests.exceptions.MissingSchema: Invalid URL 'test': No scheme supplied. Perhaps you meant https://test?
Traceback (most recent call last):
  File "/home/ubuntu/training-container/train.py", line 216, in train
    trainer.train()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1555, in train
    return inner_training_loop(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/trainer.py", line 1910, in _inner_training_loop
    self.optimizer.step()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/accelerate/optimizer.py", line 142, in step
    self.optimizer.step(closure)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/optimizer.py", line 280, in wrapper
    out = func(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/optimizer.py", line 33, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/adamw.py", line 171, in step
    adamw(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/adamw.py", line 321, in adamw
    func(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/optim/adamw.py", line 389, in _single_tensor_adamw
    exp_avg.mul_(beta1).add_(grad, alpha=1 - beta1)
RuntimeError: The size of tensor a (32768512) must match the size of tensor b (262148096) at non-singleton dimension 0
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/ubuntu/training-container/train.py", line 228, in <module>
    train()
  File "/home/ubuntu/training-container/train.py", line 223, in train
    callback_completion(data_args.callback_url,None,True,str(e))
  File "/home/ubuntu/training-container/train.py", line 46, in callback_completion
    response = requests.post(callback_url, json=payload)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/sessions.py", line 575, in request
    prep = self.prepare_request(req)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/sessions.py", line 486, in prepare_request
    p.prepare(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/models.py", line 368, in prepare
    self.prepare_url(url, params)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/requests/models.py", line 439, in prepare_url
    raise MissingSchema(
requests.exceptions.MissingSchema: Invalid URL 'test': No scheme supplied. Perhaps you meant https://test?